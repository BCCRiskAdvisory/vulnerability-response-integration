<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <active>true</active>
        <api_name>x_953551_edgescan.LocationSanitiser</api_name>
        <caller_access/>
        <client_callable>false</client_callable>
        <description/>
        <name>LocationSanitiser</name>
        <script><![CDATA[var LocationSanitiser = Class.create();
LocationSanitiser.prototype = {
    initialize: function(location) {
		this.location = location;
    },
	
	validIpAddress: function() {
		var expression = /((^\s*((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))\s*$)|(^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$))/;
		if (expression.test(this.location)) {
			return true;
		}
		return false;
	},

	retrieveHostnameFromUrl: function() {
		var matches = this.location.match(/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i);
  		return matches && matches[1];
	},

	sanitise: function() {
		var sanitisedLocation;
		if (this.validIpAddress()) {
			sanitisedLocation = {location: this.location, type: "ip"};
		}
		else {
			var hostname = this.retrieveHostnameFromUrl();
			if (hostname) {
				sanitisedLocation = {location: hostname, type: "hostname"};
			} else {
				sanitisedLocation = {location: this.location, type: "hostname"};
			}
		}
		return sanitisedLocation;
	},

    type: 'LocationSanitiser'
};]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2023-01-24 16:13:28</sys_created_on>
        <sys_id>0f0bad5e97642110f5ae72571153af8b</sys_id>
        <sys_name>LocationSanitiser</sys_name>
        <sys_package display_value="Edgescan Vulnerability Response Integration" source="x_953551_edgescan">8dd569541b2021105a8fdc6cdc4bcbb7</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="Edgescan Vulnerability Response Integration">8dd569541b2021105a8fdc6cdc4bcbb7</sys_scope>
        <sys_update_name>sys_script_include_0f0bad5e97642110f5ae72571153af8b</sys_update_name>
    </sys_script_include>
</record_update>
